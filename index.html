<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>gtm2-youtube-event-tracking by grantmarch</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/grantmarch/gtm2-youtube-event-tracking">View On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/grantmarch/gtm2-youtube-event-tracking/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/grantmarch/gtm2-youtube-event-tracking/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>gtm2-youtube-event-tracking</h1>
          <p>YouTube Event Tracking in Google Analytics for non-developers</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/grantmarch">grantmarch</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
        </div>

<h3>
<a id="target-audience" class="anchor" href="#target-audience" aria-hidden="true"><span class="octicon octicon-link"></span></a>Target Audience</h3>

<p>This tutorial is primarily aimed at non developers and describes how the code can be used in Google Tag Manager to generate YouTube events for Google Analytics (GA). A developer is required, however, to enable pages for Google Tag Manager (GTM). This can be done instead of enabling pages for GA. Developer details are included for completeness.</p>

<h3>
<a id="Goal" class="anchor" href="#Goal" aria-hidden="true"><span class="octicon octicon-link"></span></a>Goal</h3>

<p>Here is a 1:10 minute video showing the goal of being able log YouTube events, eg. play, pause, in Google Analytics.</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/iPVK8WdKCsg" frameborder="0" allowfullscreen></iframe>

<h3>
<a id="Overview" class="anchor" href="#overview" aria-hidden="true"><span class="octicon octicon-link"></span></a>Overview</h3>

<h4>Google Analytics</h4>
<p>
A small bit of Javascript can be placed on a page to allow Google Analytics (GA) (www.google.ie/analytics) to track the page. We will only be using the Tracking Id from this code here.
</p>

<h4>Google Tag Manager</h4>
<p>
Google have created Google Tag Manager (GTM) (www.google.ie/tagmanager) as an accompaniment to GA which allows non developers to be better able control what GA monitors without having to continuously request assistance from a developer. A small piece of Javascript code must be added to each page using GTM just as you would do for Google Analytics.
</p>

<p>
This tutorial specifically focuses on monitoring Youtube video events such as playing, paused, stopped, buffering, etc. But it is obviously possible to monitor other events, for example it is possible to monitor clicks on tabs on a page that load ajax content onto the same page. 
</p>

<h4>Custom Javascript</h4>
<p>
In addition to the GTM code above, a non-developer can add some custom code (by just cutting and pasting) that listens for YouTube events. This code then passes the events to a concept called the "data layer". GTM manager can "read" these events in the data layer and, in turn, pass them on to GA to monitor. This code has been tested with Chrome. Please report how it works for other browsers - some changes may be necessary.
</p>

<h4>Google Developer's Console</h4>
<p>
We will also use the Google Developer's Console (console.developers.google.com). This is not required for our event tracking as Youtube videos are tracked by their video id, eg. https://www.youtube.com/watch?v=_AhXOcM8Liw. If you click the Youtube link, you'll see that the title of this video is "Cliffs of Moher". 
</p>

<p>
We can use some of Google's Youtube Data API v3 to get the title corresponding to this video id. This means that the resulting events can be recorded in GA using the more meaningful title as opposed to the obscure video id. For security and monitoring purposes we have to request access to Google's APIs and we do this using the Google Developer's Console.
</p>

<h4>Developer vs non developer</h4>
<p>
If a Youtube video is to be embedded on a page, the web developer will be doing that anyway.
The GTM code has to be put on pages to monitor events (and more) instead of the GA code.
After that, everything else can be done by a non developer.</p>

<h3>
<a id="developer-required-tasks" class="anchor" href="#developer-required-tasks" aria-hidden="true"><span class="octicon octicon-link"></span></a>Developer Required Tasks</h3>

<h4>Finding Embed Code for YouTube Video</h4>

<p>Looking at the previous Youtube video of the Cliffs of Moher, click Share &lt; Embed and cut and paste the provided code into your web page.</p>

<img src="./sc-images/010-youtube-embed-code.png">

<h4>Web Page with Two Embedded YouTube Videos</h4>

<img src="./sc-images/020-web-page-with-2-videos.png">

<h4>Enable GTM on this Page</h4>

<p>We need to get the GTM code to put on the web page. It is suggested developers should do this as a matter of course - just as they would have done for the GA code fragment they will have used before</p>

<h4>Create GTM Account and a Container</h4>

<p>Login to www.google.ie/tagmanager and create an account. A container is used to hold one website domain that you are managing.</p>

<img src="./sc-images/030-GTM-account.png">

<h4>Add GTM Javascript Code to your Web Page</h4>

<p>You will be directed to the GTM Javascript snippet that has to be added to your web page.</p>

<img src="./sc-images/040-GTM-code-snippet.png">

<p>Your web page should now look something like this</p>

<img src="./sc-images/040-GTM-code-snippet.png">

<h4>The GTM Dashboard</h4>

<p>The GTM should be displaying its dashboard. Note that you are "in" the Container tab and you have the container you defined earlier, namely - www.<somewebsite>.com.</p>

<img src="./sc-images/050-page-with-GTM.png">

<h4>Finding your GTM Code Snippet Again</h4>

<p>If you need to find the GTM code again, to add to a different page for example, go to Admin &lt; Install Google Tag Manager. This doesn't actually "install" anything - it just shows you the GTM Javascript code again.</p>

<img src="./sc-images/060-GTM-dashboard.png">

<h3>
<a id="non-developer-tasks" class="anchor" href="#non-developer-tasks" aria-hidden="true"><span class="octicon octicon-link"></span></a>Non Developer Tasks</h3>

<h4>GTM Dashboard Again</h4>

<p>
In GTM we will primarily use 3 concepts - Variables, Triggers and Tags.
</p>

<p>
Consider Variables to be containers that can hold a value. 
Triggers send out a message that other parts of GTM can act upon. 
Tags (nothing to do with HTML tags) are units that carry out specific functionality. This will become more clear as this example is developed.
</p>

<h4>Non Developer Task Summary</h4>

<p>At this stage, our developers should have set up the page with YouTube videos to be able to "talk" to GTM. Now a non-developer can decide which pages should be monitored for YouTube events. This is a summary of the process involved.</p>

<ol>
	<li>Get YouTueb API key</li>
	<li>Create a variable in GTM, YouTubeApiKeyVar, to hold our api key for the YouTube Data v3 api. This variable is used by our custom Javascript
	which we will add later. This allows our Javascript to use the YouTube Data API v3 to get the video titles corresponding to video ids.</li>
	<li>Get GA Tracking Id</li>
	<li>Create a variable, GATrackingIdVar, which holds the Google Analytics Tracking Id which is got from our GA account. This allows GTM to send
	    event data to GA. Although we've "enabled" GTM in our web page, we still need to send events from our web page to GTM (which then sends
			them on to GA). These events are generated by some custom Javascript that a non-developer can "insert" into our page using GTM.</li>
	<li>"Insert" our own Javascript YouTube event tracking code (in a GTM tag which I will call GAYouTubeJSTag ) to monitor all the YouTube
	    videos on the page.
			When the custom Javascript hears an event, it sends a message to (what is called) the data layer. The message for the video playing
			looks like this... { 'event': 'youtube-event', 'action': 'video-playing', 'label': 'none' } ...  GTM can "see" these 3 items that make
			up an event. To make them usable in GTM we have to "convert" them into forms that GTM can manipulate.</li>
	<li>Checking your GTM Set Up...so far</li>
	<li>We will create a Trigger, YouTubeEventTrig, that is fired when a youtube-event occurs.</li>
	<li>We will create a Variable, YouTubeActionVar, that reads the data layer and gets the action</li>
	<li>We will create a Variable, called YouTubeLabelVar, that reads the data layer and gets the label.</li>
	<li>Now that everything is set up, we can create a tag, YouTubeTag, that glues all these elements together and sends the event info off to
			GA where the events can be analysed in real time and also collated over time.</li>
	<li>Remember to PUBLISH your changes.</li>
</ol>

<h3>
<a id="get-youtube-api-key" class="anchor" href="#get-youtube-api-key" aria-hidden="true"><span class="octicon octicon-link"></span></a>Get YouTube API Key</h3>

<p>Go to console.developers.google.com and Create Project
Now we can use some of the many Google APIs that are available to control and manipulate Google Products. In our case, we just want to use the YouTube Data API v3. Click on APIs and auth > APIs and enter Youtube in search box and click on YouTube Data API v3.
</p>

<img src="sc-images/080-api-console.png">

<h3>TO BE COMPLETED....</h3>
	
<h3>
<a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Authors and Contributors</h3>

<p>You can @grantmarch <a href="https://github.com/blog/821" class="user-mention">@grantmarch</a> a GitHub username to generate a link to their profile. The resulting <code>&lt;a&gt;</code> element will link to the contributorâ€™s GitHub Profile. For example: In 2007, Grant March (<a href="https://github.com/grantmarch" class="user-mention">@grantmarch</a>), PJ Hyett (<a href="https://github.com/pjhyett" class="user-mention">@pjhyett</a>), and Tom Preston-Werner (<a href="https://github.com/mojombo" class="user-mention">@mojombo</a>) founded GitHub.</p>

      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
